<%- include('partials/header.ejs') %>

  <body class="bg-[#050505] font-sans antialiased text-zinc-200">

    <main class="max-w-7xl mx-auto px-6 py-12 min-h-screen">
      <header class="mb-12">
        <h1 class="text-4xl font-black tracking-tighter text-white">Your <span class="text-zinc-500">Selection</span>
        </h1>
        <p class="text-zinc-500 text-sm mt-2">Review your items before we finalize your acquisition.</p>
      </header>

      <div class="flex flex-col lg:flex-row gap-12">
        <div class="w-full lg:w-2/3 space-y-6">
          <% if(user.cart && user.cart.length> 0) { %>
            <% user.cart.forEach(function(item) { %>
              <div
                class="group flex flex-col sm:flex-row items-center gap-6 p-6 rounded-3xl bg-zinc-900/40 border border-zinc-800/50 hover:border-zinc-600 transition-all duration-500">

                <div
                  class="w-44 h-44 flex-shrink-0 rounded-2xl overflow-hidden shadow-inner bg-[<%= item.panelcolor %>]">
                  <% if(item.image) { %>
                    <img src="data:image/jpeg;base64,<%= item.image.toString('base64') %>" alt="<%= item.name %>"
                      class="h-full w-full object-contain p-4 group-hover:scale-110 transition-transform duration-700" />
                    <% } else { %>
                      <div class="h-full w-full flex items-center justify-center opacity-20">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                          stroke="currentColor" class="w-10 h-10">
                          <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                        </svg>
                      </div>
                      <% } %>
                </div>

                <div class="flex-grow text-center sm:text-left">
                  <h3 class="text-lg font-bold text-white tracking-tight">
                    <%= item.name %>
                  </h3>
                  <p class="text-xs text-zinc-500 uppercase tracking-widest mt-1">Ref: <%=
                      item._id.toString().slice(-6).toUpperCase() %>
                  </p>
                  <div class="mt-4 flex items-center justify-center sm:justify-start gap-4">
                    <a href="/remove-from-cart/<%= item._id %>"
                      class="text-[10px] font-black uppercase tracking-widest text-red-500/70 hover:text-red-400 transition-colors">
                      Remove Item
                    </a>
                  </div>
                </div>

                <div class="text-right">
                  <p class="text-xl font-bold tracking-tighter text-[<%= item.textcolor %>]">
                    $<%= item.price.toLocaleString() %>
                  </p>
                  <% if(item.discount> 0) { %>
                    <p class="text-xs text-zinc-600 line-through">
                      $<%= (item.price + item.discount).toLocaleString() %>
                    </p>
                    <% } %>
                </div>
              </div>
              <% }) %>
                <% } else { %>
                  <div class="py-20 text-center border-2 border-dashed border-zinc-800 rounded-[3rem]">
                    <p class="text-zinc-500 font-medium">Your collection is currently empty.</p>
                    <a href="/shop"
                      class="inline-block mt-6 text-indigo-500 font-bold uppercase tracking-widest text-xs hover:text-indigo-400 transition">Return
                      to Shop</a>
                  </div>
                  <% } %>
        </div>

        <aside class="w-full lg:w-1/3">
          <div class="sticky top-12 p-8 rounded-[2.5rem] bg-zinc-900 border border-zinc-800 shadow-2xl shadow-black">
            <h2 class="text-xl font-bold text-white mb-8 tracking-tight">Order Summary</h2>
            <div class="space-y-4 mb-8">
              <div class="flex justify-between text-sm">
                <span class="text-zinc-500">Subtotal</span>
                <span class="text-white font-medium">$<%= user.price %></span>
              </div>
              <div class="flex justify-between text-sm text-emerald-500 italic">
                <span>Shipping</span>
                <span>Complimentary</span>
              </div>
              <div class="pt-4 border-t border-zinc-800 flex justify-between">
                <span class="text-lg font-bold text-white">Total</span>
                <span class="text-2xl font-black text-indigo-500 tracking-tighter">$<%= bill %></span>
              </div>
            </div>
            <button
              class="w-full bg-white text-black font-black py-5 rounded-2xl text-xs uppercase tracking-[0.2em] hover:bg-indigo-500 hover:text-white transition-all shadow-xl active:scale-95 mb-4">
              Proceed to Checkout
            </button>
          </div>
        </aside>
      </div>
    </main>
  </body>